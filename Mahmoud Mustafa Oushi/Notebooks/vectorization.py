# -*- coding: utf-8 -*-
"""Vectorization.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ZWGuJ8YZ-1VUDO2P5ptGqRGKT0lDgepF

#VECTORIZATION!!!!!!!!!!!!!!

![download.jpeg](data:image/jpeg;base64,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)

# The Task of The Week: Vectorize a JSON Dataset and Link it to an LLM to Enable the User to Send Their Queries.

---
"""

!pip install -q langchain sentence-transformers faiss-cpu transformers accelerate

"""# Convert the JSON to a Data Frame


"""

import json
import pandas as pd
import numpy as np

with open("/content/LeJson.json", "r") as f:
    data = json.load(f)

df = pd.DataFrame(data)

df.head(2)

"""# Convert the now Data Frame to Text

from what i read, doing this is required for datasets that deals with more than one feature or entry
"""

def hospital_to_text(row):
    return (
        f"Hospital Name: {row['Hospital Name']}. "
        f"Type: {row['Hospital Type']}. "
        f"Ownership: {row['Hospital Ownership']}. "
        f"Overall Rating: {row['Hospital overall rating']}. "
        f"Mortality: {row['Mortality national comparison']}. "
        f"Safety: {row['Safety of care national comparison']}. "
        f"Readmission: {row['Readmission national comparison']}. "
        f"Patient Experience: {row['Patient experience national comparison']}. "
        f"Effectiveness: {row['Effectiveness of care national comparison']}. "
        f"Timeliness: {row['Timeliness of care national comparison']}. "
        f"Efficiency of Imaging: {row['Efficient use of medical imaging national comparison']}."
    )

texts = df.apply(hospital_to_text, axis=1).tolist()
print(f"Prepared {len(texts)} hospital descriptions for embedding.")

"""# Embedding The Data Using The SentenceTransformer with The all-MiniLM-L6-v2"""

from sentence_transformers import SentenceTransformer

embedding_model = SentenceTransformer("all-MiniLM-L6-v2")
embeddings = embedding_model.encode(texts, show_progress_bar=True)

"""# Check if The Embedding Works With an Example"""

np.set_printoptions(precision=4, suppress=True)

print(f"Text:\n{texts[0]}\n")
print(f"Embedding ({len(embeddings[0])} dimensions):\n{embeddings[0]}")